# LAB: Implementation of Azure Load Balancer

Ab hum Azure Load Balancer ki end-to-end LAB karne ja rhe hain. 

**Scenario**:

Hum 2 windows VMs create karenge, dono pe IIS installed hoga aur dono ```Windows VM-1``` aur ```Windows VM-2``` text render karenge. Inke front pe ek load balancer hoga jo dono vms par load ko balance karega.

<br>
<br>

### LAB Goal

Hum Azure mein:
- 1 Virtual Network banayenge.
- 2 Windows Server VMs banayenge same Vnet ke ander.
- Dono pe IIS install karenge
- Simple webpage configure karenge:
  - VM1 â†’ "Windows Server 1".
  - VM2 â†’ "Windows Server 2".
- Inke front pe Azure Load Balancer lagayenge.
- Backend pool mein dono VMs add karenge.
- Health probe configure karenge.
- Load balancing rule configure karenge.
- Browser se verify karenge ki traffic distribute ho raha hai.

<br>
<br>

### Architecture Diagram

```
Internet
    |
Public IP (Load Balancer)
    |
Azure Load Balancer
    |
Backend Pool
   |        |
 VM1      VM2
 IIS      IIS
```

<br>
<br>

### Step-by-Step Implementation

<br>

**STEP 1 â€“ Resource Group Create Karna**:

Azure Portal:
- Go to Resource Groups.
- Click Create.
- Name: ```rg-lb-demo```.
- Region: Central India (ya jo bhi near ho).
- Create

Same region mein saare components hone chahiye.

<br>

**STEP 2 â€“ Virtual Network Create Karna**:

VMs ko ek network mein connect karne ke liye.

Create VNet:
- Name: ```vnet-lb-demo```.
- Address Space: ```10.0.0.0/24```.
- Subnet:
  - Name: ```subnet-web```
  - Address range: ```10.0.1.0/24```.
 
<br>

**STEP 3 â€“ Create VM1**:

Basic Settings:
- Name: ```vm-web-1```.
- Image: Windows Server 2019/2022.
- Size: B2s (demo ke liye).
- Username/password set karo.
- Public IP: None (IMPORTANT â€” direct internet access nahi denge).

Network:
- VNet: ```vnet-lb-demo```.
- Subnet: ```subnet-web```.
- Create.

<br>

**STEP 4 â€“ Create VM2**:

Same configuration:
- Name: ```vm-web-2```.
- Same VNet.
- Same subnet
- No Public IP.

<br>

**STEP 5 â€“ NSG Configuration**:

Because VMs ke paas public IP nahi hai, RDP kaise karenge?

Temporary:
- Ek jumpbox bana sakte ho.
- OR.
- Load Balancer NAT rule use kar sakte ho.

For simplicity:
- Letâ€™s create a temporary public IP for VM1 for setup, baad mein remove kar dena.

Allow:
- RDP (3389).
- HTTP (80).

<br>

**STEP 6 â€“ Install IIS on Both VMs**:

RDP into VM1:
- Opne Server Manager.
- Install IIS Role.

Then modify default page:
- Go to:
- ```C:\inetpub\wwwroot```.
- Edit ```iisstart.htm```.
- Replace content:
- ```<h1>Windows Server 1</h1>```.

Now VM2 pe same karo but:
```
<h1>Windows Server 2</h1>
```

<br>

**Test Individually (Before LB)**

VMs ki IP ko browser mein hit karo.

VM1 IP:

ðŸ‘‰ Windows Server 1.

VM2 IP:

ðŸ‘‰ Windows Server 2

Ab hume pata hai dono working hain.

<br>

**STEP 7 â€“ Create Azure Load Balancer**:

Type: Public Load Balancer

Configuration:
- Name: ```lb-web-demo```.
- SKU: Standard.
- Type: Public.
- Public IP: New create karo.
  - Name: ```pip-lb-web```.
 
Create.

<br>

**STEP 8 â€“ Backend Pool Configuration**:

Load Balancer â†’ Backend Pools â†’ Add

Name: ```backend-web-pool```.

Add:
- ```vm-web-1```.
- ```vm-web-2```.

<br>

**STEP 9 â€“ Health Probe Configuration**:

Why?
- Load balancer ko kaise pata chalega VM alive hai?

Create Probe:
- Name: ```http-probe```.
- Protocol: HTTP.
- Port: 80.
- Path: ```/```.
- Interval: 5 seconds.
- Threshold: 2.

<br>

**STEP 10 â€“ Load Balancing Rule Create Karna**:

Go to:
- Load Balancing Rules â†’ Add.

- Name: ```http-rule```.
- Frontend IP: Public IP
- Backend pool: backend-web-pool
- Protocol: TCP
- Port: 80
- Backend Port: 80
- Health Probe: http-probe
- Session Persistence: None.

Create.

